<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>How it works — Revenue Model (Pawthways)</title>
  <meta name="description" content="Transparency: how Pawthways generates revenue and how 40% is allocated to animal rescues. Interactive dashboard and proof documents." />
  <script>
(function(){
  function loadCDN() {
    if (window._chartCdnLoaded) return;
    var s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js';
    s.defer = true;
    s.onload = function(){ console.log('Chart.js CDN loaded'); window._chartCdnLoaded = true; };
    s.onerror = function(){ console.error('Failed to load Chart.js CDN'); };
    document.head.appendChild(s);
  }

  if (typeof Chart === 'undefined') {
    fetch('/assets/js/chart.umd.min.js', { method: 'HEAD' }).then(r => {
      if (r.ok) {
        var s = document.createElement('script');
        s.src = '/assets/js/chart.umd.min.js';
        s.defer = true;
        document.head.appendChild(s);
      } else {
        loadCDN();
      }
    }).catch(()=> {
      loadCDN();
    });
  }
})();
</script>
  <style>
    :root{
      --bg:#0f1724; 
      --card:#0b1220; 
      --muted:#9aa4b2; 
      --accent:#ffb86b; 
      --white:#eef2f7;
      --svg-node-bg:#aee1ef;
      --svg-node-text:#0b1220;
      --svg-node-charity:#ffb3b3;
      --svg-node-production:#9ecbff;
      --svg-arrow:#7b8794;
      --chart-donation:#ff8b8b;
      --chart-production:#7fb3ff;
      --tooltip-bg:#07111a;
      --tooltip-border:rgba(255,255,255,0.03);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    
    [data-theme="light"] {
      --bg:#f8fafc;
      --card:#ffffff;
      --muted:#64748b;
      --accent:#f97316;
      --white:#0f172a;
      --svg-node-bg:#0ea5e9;
      --svg-node-text:#ffffff;
      --svg-node-charity:#ef4444;
      --svg-node-production:#3b82f6;
      --svg-arrow:#475569;
      --chart-donation:#ef4444;
      --chart-production:#3b82f6;
      --tooltip-bg:#ffffff;
      --tooltip-border:rgba(0,0,0,0.1);
    }
    
    html,body{height:100%;transition:background-color 0.3s ease, color 0.3s ease}
    body{margin:0;background:var(--bg);color:var(--white);line-height:1.45;-webkit-font-smoothing:antialiased}
    .wrap{max-width:1100px;margin:32px auto;padding:24px}
    header{display:flex;gap:20px;align-items:center;flex-wrap:wrap;position:relative}
    h1{margin:.2em 0 0;font-size:26px}
    p.lead{color:var(--muted);margin-top:6px}
    .card{background:linear-gradient(180deg, rgba(128,128,128,0.05), rgba(128,128,128,0.02));padding:18px;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.15);margin:16px 0;transition:box-shadow 0.3s ease}
    [data-theme="light"] .card{box-shadow:0 2px 8px rgba(0,0,0,0.08)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
    .full{grid-column:1/-1}
    .kpi{display:flex;gap:12px;align-items:center}
    .kpi .num{font-weight:700;font-size:20px}
    .cta{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:var(--bg);text-decoration:none;font-weight:700;transition:transform 0.2s ease, box-shadow 0.2s ease}
    .cta:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,0.2)}
    footer{color:var(--muted);font-size:13px;margin-top:18px}
    pre.note{background:var(--tooltip-bg);padding:12px;border-radius:8px;color:var(--muted);overflow:auto;border:1px solid var(--tooltip-border)}
    @media (max-width:980px){.grid{grid-template-columns:1fr}.wrap{padding:18px}}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;border-bottom:1px solid var(--tooltip-border);text-align:left;color:var(--muted)}
    th{color:var(--white);font-weight:600}
    .svg-tooltip{position:fixed;pointer-events:none;padding:8px 10px;border-radius:8px;background:var(--tooltip-bg);color:var(--muted);font-size:13px;border:1px solid var(--tooltip-border);z-index:60;display:none;box-shadow:0 4px 12px rgba(0,0,0,0.2);transition:opacity 0.2s ease}
    .muted{color:var(--muted)}
    .kpiRow{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap}
    .kpiBox{background:rgba(128,128,128,0.08);padding:10px;border-radius:8px;min-width:140px;transition:background 0.3s ease}
    .kpiBox .label{color:var(--muted);font-size:13px}
    .kpiBox .value{font-weight:700;font-size:18px;margin-top:6px;color:var(--white)}
    .section-title {margin-top:12px;margin-bottom:6px;font-size:18px}
    .small {font-size:14px;color:var(--muted)}
    .impact-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-top:12px}
    .impact-card{background:rgba(128,128,128,0.08);padding:12px;border-radius:8px;transition:background 0.3s ease}
    .badge{background:rgba(255,184,107,0.15);color:var(--accent);padding:8px 12px;border-radius:999px;font-weight:700}
    [data-theme="light"] .badge{background:rgba(249,115,22,0.15)}
    .top-row{display:flex;gap:12px;align-items:center;width:100%}
    .proofs{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap}
    .proof-thumb{width:80px;height:60px;border-radius:8px;object-fit:cover;background:var(--tooltip-bg);border:1px solid var(--tooltip-border);transition:transform 0.2s ease}
    .proof-thumb:hover{transform:scale(1.05)}
    .share-buttons{display:flex;gap:8px;align-items:center}
    .faq{margin-top:12px}
    .proof-card{display:flex;gap:8px;align-items:center}
    .muted-plain{color:var(--muted);font-size:13px}
    
    /* Theme Toggle Button */
    .theme-toggle{
      position:absolute;
      top:0;
      right:0;
      background:var(--card);
      border:1px solid var(--tooltip-border);
      border-radius:8px;
      padding:8px 12px;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:6px;
      font-size:14px;
      color:var(--white);
      transition:all 0.2s ease;
      z-index:100;
    }
    .theme-toggle:hover{
      background:rgba(128,128,128,0.1);
      transform:translateY(-1px);
    }
    .theme-toggle:focus{
      outline:2px solid var(--accent);
      outline-offset:2px;
    }
    .theme-icon{
      width:18px;
      height:18px;
      fill:currentColor;
    }
    
    /* SVG improvements */
    #flow-svg text{
      font-size:12px;
      pointer-events:none;
      text-shadow:0 1px 2px rgba(0,0,0,0.3);
    }
    #flow-svg .node circle{
      transition:all 0.3s ease;
    }
    #flow-svg .node:hover circle{
      filter:brightness(1.1);
      stroke:var(--accent);
      stroke-width:2;
    }
    @media (max-width:600px){
      #flow-svg text{font-size:10px}
      .theme-toggle{font-size:0;padding:8px}
      .theme-toggle .theme-icon{margin:0}
    }
  </style>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "name":"Pawthways",
    "url":"https://yourdomain.example",
    "description":"Digital products that fund animal rescues — 40% of revenue donated to verified causes.",
    "logo":"https://yourdomain.example/assets/logo.png"
  }
  </script>
</head>
<body>
  <main class="wrap" role="main">
    <header>
      <button 
        id="themeToggle" 
        class="theme-toggle" 
        aria-label="Toggle light/dark theme"
        aria-pressed="false"
        type="button">
        <svg class="theme-icon" aria-hidden="true" viewBox="0 0 24 24">
          <path id="sunIcon" d="M12 18a6 6 0 100-12 6 6 0 000 12zM12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41"/>
          <path id="moonIcon" style="display:none" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
        <span class="theme-label">Theme</span>
      </button>
      
      <div style="flex:1">
        <h1>How it works — Revenue Model (Pawthways)</h1>
        <p class="lead">Full transparency: how Pawthways generates revenue and how 40% is allocated to verified rescues. Real numbers, proof documents and up-to-date KPIs.</p>
        <div style="margin-top:10px" class="top-row">
          <div class="badge">40% → Donated</div>
          <div style="margin-left:12px" class="muted-plain">Fixed, audited distribution • <a href="/transparency.html" style="color:var(--accent);text-decoration:none">View dashboard</a></div>
        </div>
      </div>

      <div style="text-align:right">
        <div style="font-size:13px;color:var(--muted)">Last updated</div>
        <div id="last-updated-large" style="font-weight:700;margin-top:6px">—</div>
        <div class="share-buttons" style="margin-top:12px">
          <a id="share-twitter" title="Share on Twitter" style="color:var(--muted);text-decoration:none">Share</a>
        </div>
      </div>
    </header>

    <section id="introduction" class="card full" aria-labelledby="intro-title">
      <h2 id="intro-title">Introduction to the Revenue Model</h2>
      <p class="small">
        Pawthways operates on two rails: <strong>commercial revenue</strong> (digital products & upsells) and a fixed <strong>charitable allocation</strong> (40% of revenue). We publish aggregated metrics and proof documents so anyone can verify where money goes.
      </p>
      <p class="muted">This page contains the flow diagram, live KPIs (when available), distribution breakdown, example impacts and proof documents.</p>
      <div class="proofs" id="proofs">
        <div class="muted-plain">Most recent proofs: </div>
      </div>
    </section>

    <section class="card full" aria-labelledby="kpi-summary">
      <h2 id="kpi-summary">Quick numbers (live)</h2>
      <div class="kpiRow" id="kpiRow">
        <div class="kpiBox">
          <div class="label">Total revenue</div>
          <div class="value" id="k_total_revenue">—</div>
        </div>
        <div class="kpiBox">
          <div class="label">Total reserved / donated</div>
          <div class="value" id="k_total_reserved">—</div>
        </div>
        <div class="kpiBox">
          <div class="label">Donation %</div>
          <div class="value" id="k_donation_pct">—</div>
        </div>
        <div class="kpiBox">
          <div class="label">Pending allocations</div>
          <div class="value" id="k_pending">—</div>
        </div>
      </div>
      <p class="small" style="margin-top:10px">Numbers come from <code>/api/admin-stats</code>. If disabled, we fallback to the default 40/60 split.</p>
    </section>

    <section class="grid" aria-labelledby="flow-title">
      <article class="card" aria-labelledby="flow-title">
        <h3 id="flow-title">Revenue generation & distribution flow</h3>
        <p class="muted" style="margin-top:6px">Hover / tap the nodes to see details. Click proofs to inspect receipts.</p>
        <div style="width:100%;height:300px;margin-top:12px">
          <svg id="flow-svg" viewBox="0 0 1000 300" role="img" aria-label="Interactive revenue flow diagram" style="width:100%;height:100%">
            <g class="node" data-title="Digital product sales" data-desc="Sales of products on Whop (artbooks, AI packs, music)">
              <circle cx="170" cy="200" r="40" fill="var(--svg-node-bg)" stroke-width="0"></circle>
              <text x="170" y="205" font-weight="700" text-anchor="middle" fill="var(--svg-node-text)">Digital<tspan x="170" dy="14">Products</tspan></text>
            </g>
            <g class="node" data-title="Whop (platform)" data-desc="Payment processing platform.">
              <circle cx="420" cy="120" r="46" fill="var(--svg-node-bg)" stroke-width="0"></circle>
              <text x="420" y="125" font-weight="700" text-anchor="middle" fill="var(--svg-node-text)">Whop</text>
            </g>
            <g class="node" data-title="Generated revenue" data-desc="Revenue registered in the DB (sales).">
              <circle cx="620" cy="120" r="64" fill="var(--svg-node-bg)" stroke-width="0"></circle>
              <text x="620" y="118" font-weight="700" text-anchor="middle" fill="var(--svg-node-text)">Generated<tspan x="620" dy="14">Revenue</tspan></text>
            </g>
            <g class="node" data-title="Donations (40%)" data-desc="40% redirected to verified NGOs (rescue, vet care, rehab)">
              <circle cx="920" cy="200" r="54" fill="var(--svg-node-charity)" stroke-width="0"></circle>
              <text x="920" y="195" font-weight="700" text-anchor="middle" fill="var(--svg-node-text)">Charitable<tspan x="920" dy="14">Causes</tspan><tspan x="920" dy="14">(40%)</tspan></text>
            </g>
            <g class="node" data-title="Production & growth (60%)" data-desc="60% for team, marketing and content production">
              <circle cx="160" cy="30" r="48" fill="var(--svg-node-production)" stroke-width="0"></circle>
              <text x="160" y="25" font-weight="700" text-anchor="middle" fill="var(--svg-node-text)">Production<tspan x="160" dy="14">(60%)</tspan></text>
            </g>
            <defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="6" refY="5" orient="auto"><path d="M0,0 L10,5 L0,10 z" fill="var(--svg-arrow)"></path></marker></defs>
            <path d="M210 195 C300 170 360 140 380 135" stroke="var(--svg-arrow)" stroke-width="3" fill="none" marker-end="url(#arrow)"></path>
            <path d="M470 120 C540 120 580 120 610 120" stroke="var(--svg-arrow)" stroke-width="3" fill="none" marker-end="url(#arrow)"></path>
            <path d="M680 150 C760 170 820 185 870 195" stroke="var(--svg-arrow)" stroke-width="3" fill="none" marker-end="url(#arrow)"></path>
            <path d="M680 100 C560 70 300 48 220 48" stroke="var(--svg-arrow)" stroke-width="3" fill="none" marker-end="url(#arrow)"></path>
          </svg>
        </div>
      </article>

      <aside class="card" aria-labelledby="chart-title">
        <h4 id="chart-title">Interactive distribution</h4>
        <p class="muted" style="margin-top:6px">Real-time when the endpoint is available. Click legends to toggle slices.</p>
        <div style="margin-top:10px">
          <canvas id="revenuePie" width="320" height="320" aria-label="Revenue distribution pie chart" role="img"></canvas>
        </div>
        <div style="margin-top:12px" id="chart-note" class="muted">Last updated: <span id="last-updated">--</span></div>
        <div style="margin-top:14px">
          <a href="/shop.html" class="cta" id="buy-now">Buy a pack — 40% goes to animal rescues</a>
          <a style="margin-left:10px;color:var(--muted)" href="/transparency.html">Full dashboard</a>
        </div>
      </aside>
    </section>

    <section id="sources" class="card full" aria-labelledby="sources-title">
      <h3 id="sources-title">Sources of Income</h3>
      <p class="small">Main sources: product sales (artbooks, AI packs, music), upsells and merchandising. 40% of revenue is allocated to verified animal welfare causes.</p>

      <div class="section-title">How income is generated</div>
      <p class="small">Sales are processed via Whop. Each purchase funds project growth and the charitable allocation. Products include behind-the-scenes education so users can replicate the process.</p>
    </section>

    <section id="distribution" class="card full" aria-labelledby="distribution-title">
      <h3 id="distribution-title">Revenue Distribution</h3>
      <p class="small">We split revenue clearly:</p>

      <table aria-describedby="distribution-title">
        <thead><tr><th>Allocation</th><th>Percentage</th><th>Purpose</th></tr></thead>
        <tbody>
          <tr><td>Charitable Causes</td><td>40%</td><td>Funding verified NGOs (rescue, vet care, rehab, feeding).</td></tr>
          <tr><td>Production & Growth</td><td>60%</td><td>Content, team, marketing, product development, platform ops.</td></tr>
        </tbody>
      </table>

      <div class="section-title">Transparency in Distribution</div>
      <p class="small">We publish aggregated transaction metrics and proof documents on the Transparency Dashboard. No PII is shown; only aggregated numbers and proof docs (receipts, invoices).</p>
    </section>

    <section id="impact" class="card full" aria-labelledby="impact-title">
      <h3 id="impact-title">Example impact</h3>
      <div class="impact-grid">
        <div class="impact-card">
          <strong>€30</strong>
          <div class="small">≈ 3 days of feeding for a small shelter dog</div>
        </div>
        <div class="impact-card">
          <strong>€100</strong>
          <div class="small">≈ basic medical check & vaccine</div>
        </div>
        <div class="impact-card">
          <strong>€500</strong>
          <div class="small">≈ emergency surgery / rehabilitation</div>
        </div>
      </div>
      <p class="muted" style="margin-top:10px">These help donors understand the real-world effect of the 40% allocation.</p>
    </section>

    <section id="implementation" class="card full" aria-labelledby="impl-title">
      <h3 id="impl-title">Technical implementation & data</h3>
      <ol>
        <li>We use <code>/api/admin-stats</code> for aggregates. Fields expected: <code>{ total_sales, total_reserved, pending, generated_at }</code>.</li>
        <li>Proof documents are served from <code>/api/transparency-proofs</code> (public view); each proof contains a secure URL to the invoice/receipt.</li>
        <li>This page reads aggregates only - no PII is published.</li>
      </ol>
      <pre class="note">NOTE: allocate and audit_donations_log run backend. This page reads public views only.</pre>
    </section>

    <section class="card full" aria-labelledby="faq-title">
      <h3 id="faq-title">FAQ — quick answers</h3>
      <div class="faq">
        <p><strong>How can I verify that the 40% donation is real?</strong> — Every month we publish receipts and proof documents (see the "Proofs" section). The public transparency view also shows the exact reserved amount. You can download all proof documents anytime.</p>
        <p><strong>Where does the money go?</strong> — To verified animal welfare organizations (rescue, veterinary care, rehabilitation, feeding). The names and links appear inside each proof document.</p>
        <p><strong>Can I request a detailed report?</strong> — Yes. Contact us at <a href="mailto:contact@pawthways.example" style="color:var(--accent)">contact@pawthways.example</a> and we'll provide one.</p>
      </div>
    </section>

    <section id="cta" class="card full">
      <h3>Get involved</h3>
      <p class="small">See our packs, learn the process, and fund rescues by buying one of our packs. Every purchase funds real rescues.</p>
      <a class="cta" href="/shop.html">See products — help animals</a>
      <a style="margin-left:10px;color:var(--muted)" href="/transparency.html">View full transparency</a>
    </section>

    <footer>
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <div>© Pawthways — Transparency & responsibility.</div>
        <div class="muted">Documentation: revenue model and operational checklist.</div>
      </div>
    </footer>
  </main>

  <div id="svgTooltip" class="svg-tooltip" role="tooltip" aria-hidden="true"></div>

  <script>
  // Theme toggle with memory persistence
  (function(){
    if (window._themeToggleInitialized) return;
    window._themeToggleInitialized = true;
    
    const btn = document.getElementById('themeToggle');
    const sunIcon = document.getElementById('sunIcon');
    const moonIcon = document.getElementById('moonIcon');
    
    if (!btn || !sunIcon || !moonIcon) {
      console.warn('theme-toggle: elements not found');
      return;
    }
    
    // Get saved theme or default to dark
    const savedTheme = window.localStorage.getItem('pawthways-theme') || 'dark';
    
    function applyTheme(theme) {
      console.log('theme-toggle: applying', theme);
      document.documentElement.setAttribute('data-theme', theme);
      
      if (theme === 'light') {
        sunIcon.style.display = 'none';
        moonIcon.style.display = 'block';
        btn.setAttribute('aria-pressed', 'true');
      } else {
        sunIcon.style.display = 'block';
        moonIcon.style.display = 'none';
        btn.setAttribute('aria-pressed', 'false');
      }
      
      // Update chart colors if chart exists
      if (window.revenueChartInstance && window.revenueChartInstance.data) {
        const isDark = theme === 'dark';
        const colors = isDark ? ['#ff8b8b', '#7fb3ff'] : ['#ef4444', '#3b82f6'];
        window.revenueChartInstance.data.datasets[0].backgroundColor = colors;
        window.revenueChartInstance.options.plugins.legend.labels.color = isDark ? '#e6eef7' : '#0f172a';
        window.revenueChartInstance.update();
        console.log('theme-toggle: chart updated');
      }
    }
    
    applyTheme(savedTheme);
    
    btn.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme') || 'dark';
      const next = current === 'dark' ? 'light' : 'dark';
      window.localStorage.setItem('pawthways-theme', next);
      applyTheme(next);
    });
    
    console.log('theme-toggle: initialized');
  })();
  
  // Chart shim
  if (typeof Chart === 'undefined') {
    window.Chart = function(ctx, config){ 
      this.data = (config && config.data) ? config.data : { datasets: [] }; 
      this.options = (config && config.options) ? config.options : {};
      this.update = function(){}; 
    };
  }
  
  // SVG tooltip logic
  (function(){
    const svg = document.getElementById('flow-svg');
    const tooltip = document.getElementById('svgTooltip');
    if (!svg || !tooltip) return;
    
    function showTooltip(evt, title, desc) {
      const clientX = evt.clientX || (evt.touches && evt.touches[0] && evt.touches[0].clientX) || 0;
      const clientY = evt.clientY || (evt.touches && evt.touches[0] && evt.touches[0].clientY) || 0;
      tooltip.style.left = (clientX + 12) + 'px';
      tooltip.style.top = (clientY + 12) + 'px';
      tooltip.innerHTML = '<strong style="color:var(--white)">' + title + '</strong><div style="margin-top:6px;font-size:13px">' + desc + '</div>';
      tooltip.style.display = 'block';
      tooltip.style.opacity = '1';
      tooltip.setAttribute('aria-hidden','false');
    }
    
    function hideTooltip(){ 
      tooltip.style.opacity = '0';
      setTimeout(() => {
        tooltip.style.display = 'none';
        tooltip.setAttribute('aria-hidden','true');
      }, 200);
    }
    
    svg.querySelectorAll('.node').forEach(g => {
      const title = g.getAttribute('data-title') || '';
      const desc = g.getAttribute('data-desc') || '';
      g.style.cursor = 'pointer';
      g.addEventListener('mousemove', (e)=> showTooltip(e, title, desc));
      g.addEventListener('mouseleave', hideTooltip);
      g.addEventListener('touchstart', (e)=> { e.preventDefault(); showTooltip(e.touches[0], title, desc); }, {passive:false});
      g.addEventListener('touchend', hideTooltip);
    });
  })();

  // Chart + fetch + proofs fetch
  (function(){
    const canvasEl = document.getElementById('revenuePie');
    const ctx = canvasEl && canvasEl.getContext ? canvasEl.getContext('2d') : null;
    
    const theme = document.documentElement.getAttribute('data-theme') || 'dark';
    const isDark = theme === 'dark';
    const colors = isDark ? ['#ff8b8b', '#7fb3ff'] : ['#ef4444', '#3b82f6'];
    const labelColor = isDark ? '#e6eef7' : '#0f172a';
    
    const defaultData = {
      labels: ['Donations (40%)', 'Production & Growth (60%)'],
      datasets: [{ data: [40,60], backgroundColor: colors, hoverOffset:8 }]
    };
    
    const config = { 
      type:'pie', 
      data: defaultData, 
      options: { 
        responsive:true, 
        plugins:{ 
          legend:{ 
            position:'bottom', 
            labels:{ color: labelColor }